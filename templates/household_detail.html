<head>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <link rel="stylesheet" href="{{ url_for('static',filename='styles.css') }}">
</head>

<body>
<div class="container">
    <h2>Household App - ID: {{ household_id }}</h2>
    <p>Status: {{ household_info[2] }}, Balance: ${{ household_info[3] }}</p>

    <h3>Available Vouchers</h3>
    <form action="/household/{{ household_id }}/redeem" method="post">
        <div class="voucher-grid">
            {% for value, count in vouchers.items() %}
                {% for i in range(count) %}
                    <input type="checkbox" id="voucher_{{ value }}_{{ i }}" name="redeem" value="{{ value }}">
                    <label for="voucher_{{ value }}_{{ i }}">${{ value }}</label>
                {% endfor %}
            {% endfor %}
        </div>
        <p>Total to be redeemed: $<span id="total">0</span></p>
        <input type="hidden" name="total_amount" id="total_amount">
        <input type="submit" value="Redeem Selected Vouchers">
    </form>
    {% if message %}
        <p>{{ message }}</p>
    {% endif %}
</div>
</body>

<script>
    const checkboxes = document.querySelectorAll('.voucher-grid input[type="checkbox"]');
    const totalEl = document.getElementById('total');

    function updateTotal() {
        let total = 0;
        checkboxes.forEach(cb => {
            if (cb.checked) {
                total += parseInt(cb.value);
            }
        });
        totalEl.textContent = total;
        document.getElementById('total_amount').value = total;
    }

    // Add event listener to every checkbox
    checkboxes.forEach(cb => cb.addEventListener('change', updateTotal));
</script>